<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil de Usuario</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

    <div class="container mt-5">
        <button class="btn btn-primary" onclick="window.history.back()">Go back</button>
        <div id="userProfile" class="text-center mb-5">
            <h1 id="userName"></h1>
            <p id="userBio"></p>
        </div>

        <h2>Contenido del Usuario</h2>
        <div id="contentContainer" class="row g-4">
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const API_URL_BLOG = 'http://localhost:3000/blog';
        const urlParams = new URLSearchParams(window.location.search);
        const blogId = urlParams.get('user');
        const fetchUserProfile = async () => {
            try {
                const userResponse = await fetch(`${API_URL_BLOG}/content-user/${blogId}`);
                const userData = await userResponse.json();

                if (userData.success && userResponse.ok) {
                    document.getElementById('userName').innerText = userData.data.name;
                    document.getElementById('userBio').innerText = userData.data.bio;


                    createBlogs(userData.data.blogs);
                } else {
                    alert('No se pudo cargar el perfil del usuario.');
                }
            } catch (error) {
                console.error('Error al recuperar el perfil del usuario:', error);
            }
        }

        // Funci칩n para crear las cards con los blogs
        const createBlogs = (blogs) => {
            const contentContainer = document.getElementById('contentContainer');
            const blogsNodes = blogs.map(blog => {
                const blogNode = document.createElement('div');
                blogNode.classList.add('col-12', 'col-sm-6', 'col-md-4', 'mb-4');

                blogNode.innerHTML = `
                    <div class="card">
                        <div class="card-header">
                            <h5>Name :</h5>
                            <strong>${blog.title}</strong>
                        </div>
                        <div class="card-body">
                            <h5>Biography :</h5>
                            <p>${blog.content}</p>
                        </div>
                    </div>
                `;
                return blogNode;
            });

            contentContainer.innerHTML = '';
            blogsNodes.forEach(blogNode => contentContainer.appendChild(blogNode));
        }

        // Funci칩n para redirigir al detalle del blog
        const viewBlog = (blogId) => {
            window.location.href = `${API_URL_USER}/view/${blogId}`;
        }

        // Llamar a la funci칩n para cargar los datos del usuario al cargar la p치gina
        window.onload = fetchUserProfile;
    </script>

</body>
</html>
